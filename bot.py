import os
import logging
import telebot
from telebot import types

# =========================
# CONFIG
# =========================
TOKEN = (os.environ.get("TOKEN") or "").strip()
ADMIN_CHAT_ID = (os.environ.get("ADMIN_CHAT_ID") or "").strip()  # –ø—Ä–∏–º–µ—Ä: -5268865051

if not TOKEN:
    raise RuntimeError("TOKEN env var is not set")

if not ADMIN_CHAT_ID:
    raise RuntimeError("ADMIN_CHAT_ID env var is not set (example: -5268865051)")

ADMIN_CHAT_ID = int(ADMIN_CHAT_ID)

logging.basicConfig(level=logging.INFO, format="%(asctime)s [%(levelname)s] %(message)s")
log = logging.getLogger("eg-bot")

bot = telebot.TeleBot(TOKEN, parse_mode="HTML")
ADMIN_LINK = "https://t.me/beautyspace_admin"

BASE_DIR = os.path.dirname(os.path.abspath(__file__))
IMAGES_DIR = os.path.join(BASE_DIR, "images")

# =========================
# UI BUTTONS (UA)
# =========================
BTN_HOME = "üè† –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é"
BTN_BACK = "‚¨ÖÔ∏è –ù–∞–∑–∞–¥"

BTN_SALON = "–°–∞–ª–æ–Ω"
BTN_SHOP = "–ú–∞–≥–∞–∑–∏–Ω –∫–æ—Å–º–µ—Ç–∏–∫–∏"
BTN_ADMIN = "–ó–≤'—è–∑–∞—Ç–∏—Å—è –∑ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"
BTN_PRICE = "–ü—Ä–∞–π—Å —Å–∞–ª–æ–Ω—É"

BTN_REDKEN = "Redken"
BTN_EG = "EG by Gromova"

BTN_CART = "üß∫ –ö–æ—à–∏–∫"
BTN_CART_SHOW = "–ü–æ–∫–∞–∑–∞—Ç–∏ –∫–æ—à–∏–∫"
BTN_CART_CLEAR = "–û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ—à–∏–∫"
BTN_CHECKOUT = "‚úÖ –û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"

BTN_CHOOSE_VOLUME = "–í–∏–±—Ä–∞—Ç–∏ –æ–± º—î–º"
BTN_ADD_TO_CART = "–î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫"
BTN_HOW_TO_USE = "–Ø–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏"

def get_photo_file(photo_rel_path: str):
    """
    photo_rel_path ‚Äî –ø—É—Ç—å –í–ù–£–¢–†–ò –ø–∞–ø–∫–∏ images, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    "redken/redken-all-soft-shampoo-300ml.jpg"
    """
    try:
        full_path = os.path.join(IMAGES_DIR, photo_rel_path)
        return open(full_path, "rb")
    except Exception as e:
        log.exception("Photo not found/open error: %s (%s)", photo_rel_path, e)
        return None
# =========================
# HELPERS
# =========================
def is_private(message: types.Message) -> bool:
    return message.chat.type == "private"


def safe_send_to_admin(text: str) -> bool:
    try:
        bot.send_message(
            ADMIN_CHAT_ID,
            text,
            reply_markup=types.ReplyKeyboardRemove(),
            disable_web_page_preview=True
        )
        return True
    except Exception as e:
        log.exception("Failed to send to admin chat: %s", e)
        return False


def try_send_photo(chat_id: int, photo_path: str, caption: str, reply_markup):
    """
    –ù–∞–¥—ë–∂–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ç–æ.
    –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø—É—Ç—è–º–∏:
      - "images/xxx.jpg" (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π)
      - "/abs/path/images/xxx.jpg" (–∞–±—Å–æ–ª—é—Ç–Ω—ã–π)
    –ö–æ–≥–¥–∞ —Ñ–∞–π–ª–∞ –Ω–µ—Ç –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç.
    """
    try:
        p = (photo_path or "").strip()

        # –ü—É—Å—Ç–æ–π –ø—É—Ç—å -> –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
        if not p:
            bot.send_message(chat_id, caption, reply_markup=reply_markup)
            return

        # –°–æ–±–∏—Ä–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å
        abs_path = p if os.path.isabs(p) else os.path.join(BASE_DIR, p)

        # –§–∞–π–ª–∞ –Ω–µ—Ç -> –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
        if not os.path.exists(abs_path):
            log.warning("Photo not found: %s", abs_path)
            bot.send_message(chat_id, caption, reply_markup=reply_markup)
            return

        # Telebot –Ω—É–∂–µ–Ω —Ñ–∞–π–ª-–æ–±—ä–µ–∫—Ç, –Ω–µ —Å—Ç—Ä–æ–∫–∞ –ø—É—Ç–∏
        with open(abs_path, "rb") as f:
            bot.send_photo(chat_id, f, caption=caption, reply_markup=reply_markup)

    except Exception as e:
        log.exception("Failed to send photo '%s': %s", photo_path, e)
        bot.send_message(chat_id, caption, reply_markup=reply_markup)
# =========================
# KEYBOARDS
# =========================

def kb_main():
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.row(BTN_SALON, BTN_SHOP)
    kb.row(BTN_CART)
    kb.row(BTN_ADMIN)
    return kb


def kb_salon():
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.row(BTN_PRICE)
    kb.row(BTN_ADMIN)
    kb.row(BTN_HOME)
    return kb


def kb_price(services):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    if services:
        for row in services:
            if isinstance(row, (list, tuple)):
                kb.row(*row)
            else:
                kb.row(row)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_shop():
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.row(BTN_REDKEN, BTN_EG)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_lines(lines):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    if lines:
        for row in lines:
            if isinstance(row, (list, tuple)):
                kb.row(*row)
            else:
                kb.row(row)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_items(rows):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    if rows:
        for row in rows:
            if isinstance(row, (list, tuple)):
                kb.row(*row)
            else:
                kb.row(row)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_product():
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.row(BTN_CHOOSE_VOLUME)
    kb.row(BTN_ADD_TO_CART)
    kb.row(BTN_HOW_TO_USE)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_volumes(volume_buttons_rows):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    if volume_buttons_rows:
        for row in volume_buttons_rows:
            if isinstance(row, (list, tuple)):
                kb.row(*row)
            else:
                kb.row(row)
    kb.row(BTN_BACK, BTN_HOME)
    return kb


def kb_cart():
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.row(BTN_CART_SHOW)
    kb.row(BTN_CART_CLEAR)
    kb.row(BTN_CHECKOUT)
    kb.row(BTN_BACK, BTN_HOME)
    return kb

# =========================
# SALON SERVICES
# =========================
SVC_CAMO = "–ö–∞–º—É—Ñ–ª—è–∂ —Å–∏–≤–∏–Ω–∏"
SVC_TONE = "–¢–æ–Ω—É–≤–∞–Ω–Ω—è"
SVC_COLOR = "–§–∞—Ä–±—É–≤–∞–Ω–Ω—è"
SVC_INTEGR = "–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —Å–∏–≤–∏–Ω–∏"
SVC_HIGHL = "–ú–µ–ª—ñ—Ä—É–≤–∞–Ω–Ω—è"
SVC_AIRTOUCH = "Airtouch"
SVC_DARK_OUT = "–í–∏—Ö—ñ–¥ –∑ —Ç–µ–º–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É"
SVC_CUT = "–°—Ç—Ä–∏–∂–∫–∞"
SVC_RECON = "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova"

SERVICE_TEXTS = {
    SVC_CAMO: "–ö–∞–º—É—Ñ–ª—è–∂ —Å–∏–≤–∏–Ω–∏ ‚ú®\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 3000 –≥—Ä–Ω\n–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: –¥–æ 1 –≥–æ–¥–∏–Ω–∏\n\n"
              "–©–æ –≤—Ö–æ–¥–∏—Ç—å —É –ø—Ä–æ—Ü–µ–¥—É—Ä—É:\n‚Ä¢ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è –º–∞–π—Å—Ç—Ä–∞\n‚Ä¢ –ø—ñ–¥–±—ñ—Ä –≤—ñ–¥—Ç—ñ–Ω–∫—É\n"
              "‚Ä¢ –º‚Äô—è–∫–µ —Ç–æ–Ω—É–≤–∞–Ω–Ω—è —Å–∏–≤–∏–Ω–∏ –±–µ–∑ –∑–º—ñ–Ω–∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É\n‚Ä¢ —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è –∫–æ–ª—å–æ—Ä—É\n"
              "‚Ä¢ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ø–æ –¥–æ–≥–ª—è–¥—É\n\n‚ö†Ô∏è –ö–∞–º—É—Ñ–ª—è–∂ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –Ω–µ –≤—Å—ñ–º.\n"
              "–ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å–æ–º –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è.\n\n"
              "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ.",

    SVC_TONE: "–¢–æ–Ω—É–≤–∞–Ω–Ω—è üé®\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 3000 –≥—Ä–Ω\n\n–©–æ –≤—Ö–æ–¥–∏—Ç—å:\n"
              "‚Ä¢ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥—Ç—ñ–Ω–∫—É —Ñ–∞—Ä–±–Ω–∏–∫–æ–º Redken\n‚Ä¢ –∫–æ—Ä–µ–∫—Ü—ñ—è –Ω—é–∞–Ω—Å—É –∫–æ–ª—å–æ—Ä—É\n‚Ä¢ —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è\n\n"
              "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ.",

    SVC_COLOR: "–°—Ç—ñ–π–∫–µ —Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è üñ§\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 3500 –≥—Ä–Ω\n\n"
               "–©–æ –≤—Ö–æ–¥–∏—Ç—å:\n‚Ä¢ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è\n‚Ä¢ —Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è –∫–æ—Ä–µ–Ω—è –∞–±–æ –∫–æ—Ä–µ–Ω—è + –¥–æ–≤–∂–∏–Ω–∏\n‚Ä¢ —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è –∫–æ–ª—å–æ—Ä—É\n\n"
               "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ.",

    SVC_INTEGR: "–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —Å–∏–≤–∏–Ω–∏ ü§ç\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 12000 –≥—Ä–Ω\n–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: 6‚Äì10 –≥–æ–¥–∏–Ω\n\n"
                "–ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å–æ–º –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è.\n\n"
                "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ —Ç–∞ –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ.",

    SVC_HIGHL: "–ú–µ–ª—ñ—Ä—É–≤–∞–Ω–Ω—è üåü\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 12000 –≥—Ä–Ω\n–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: 4‚Äì6 –≥–æ–¥–∏–Ω\n\n"
               "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ —Ç–∞ –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ.",

    SVC_AIRTOUCH: "Airtouch üí®\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 12000 –≥—Ä–Ω\n–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: 6‚Äì8 –≥–æ–¥–∏–Ω\n\n"
                  "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ —Ç–∞ –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ.",

    SVC_DARK_OUT: "–í–∏—Ö—ñ–¥ –∑ —Ç–µ–º–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É üö™\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 15000 –≥—Ä–Ω\n\n"
                  "‚ö†Ô∏è –ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å–æ–º –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è.\n"
                  "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∞ —Ç–∞ –æ–ø–ª–∞—á—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ.",

    SVC_CUT: "–°—Ç—Ä–∏–∂–∫–∞ ‚úÇÔ∏è\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: 1200 –≥—Ä–Ω\n\n"
             "–©–æ –≤—Ö–æ–¥–∏—Ç—å:\n‚Ä¢ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è\n‚Ä¢ –º–∏—Ç—Ç—è –≥–æ–ª–æ–≤–∏\n‚Ä¢ —É–∫–ª–∞–¥–∫–∞",

    SVC_RECON: "–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è 8D by Gromova üß¨\n\n–í–∞—Ä—Ç—ñ—Å—Ç—å: –≤—ñ–¥ 2500 –≥—Ä–Ω\n–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: –¥–æ 2 –≥–æ–¥–∏–Ω\n\n"
               "8D by Gromova ‚Äî –∞–≤—Ç–æ—Ä—Å—å–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–ª–∏–±–æ–∫–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–æ–ª–æ—Å—Å—è."
}

PRICE_ROWS = [
    (SVC_CAMO, SVC_INTEGR),
    (SVC_TONE, SVC_COLOR),
    (SVC_HIGHL, SVC_AIRTOUCH),
    (SVC_DARK_OUT, SVC_CUT),
    (SVC_RECON,),
]

# =========================
# CATALOG (Redken)
# photo_path: –ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É, –Ω–∞–ø—Ä–∏–º–µ—Ä "images/–∏–º—è.jpg"
# btn: —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é —Ç–æ–≤–∞—Ä–æ–≤
# =========================
CATALOG = {
    "Redken": {
        "lines": {

            "Acidic Bonding": {
                "items": {
                    "acidic_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Acidic Bonding",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Acidic Bonding",
                        "photo_path": "images/redken-acidic-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –ó–º—ñ—Ü–Ω—é—î, –∑–º–µ–Ω—à—É—î –ª–∞–º–∫—ñ—Å—Ç—å, –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏—Ä—ñ–≤–Ω—è—Ç–∏ pH –ø—ñ—Å–ª—è —Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏. –ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏.",
                        "volumes": {
                            "300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950},
                            "500 –º–ª ‚Äî 1250 –≥—Ä–Ω": {"ml": 500, "price": 1250},
                        }
                    },
                    "acidic_conditioner": {
                        "btn": "üîπ –ë–∞–ª—å–∑–∞–º Acidic Bonding",
                        "title": "–ë–∞–ª—å–∑–∞–º Redken Acidic Bonding",
                        "photo_path": "images/redken-acidic-conditioner.jpg",
                        "short": "–ë–∞–ª—å–∑–∞–º –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è —Ç–∞ –≥–ª–∞–¥–∫–æ—Å—Ç—ñ. –ó–∞–∫—Ä–∏–≤–∞—î –∫—É—Ç–∏–∫—É–ª—É, –∑–º–µ–Ω—à—É—î —Å—É—Ö—ñ—Å—Ç—å —ñ –ø—É—Ö–Ω–∞—Å—Ç—ñ—Å—Ç—å –¥–æ–≤–∂–∏–Ω–∏.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –ø—ñ—Å–ª—è —à–∞–º–ø—É–Ω—é, –≤–∏—Ç—Ä–∏–º–∞—Ç–∏ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {
                            "300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950},
                            "500 –º–ª ‚Äî 1250 –≥—Ä–Ω": {"ml": 500, "price": 1250},
                        }
                    },
                    "acidic_mask": {
                        "btn": "üîπ –ú–∞—Å–∫–∞ Acidic Bonding",
                        "title": "–ú–∞—Å–∫–∞ Redken Acidic Bonding",
                        "photo_path": "images/redken-acidic-mask.jpg",
                        "short": "–Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞ –º–∞—Å–∫–∞ –¥–ª—è –≥–ª–∏–±–æ–∫–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –≤–æ–ª–æ—Å—Å—é –ø—ñ—Å–ª—è –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è —Ç–∞ —Ñ–∞—Ä–±—É–≤–∞–Ω–Ω—è.",
                        "how_to_use": "–ü—ñ—Å–ª—è —à–∞–º–ø—É–Ω—é –Ω–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω, –∑–º–∏—Ç–∏. 1‚Äì2 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.",
                        "volumes": {
                            "250 –º–ª ‚Äî 1300 –≥—Ä–Ω": {"ml": 250, "price": 1300},
                        }
                    },
                    "acidic_leavein": {
                        "btn": "üîπ –ö—Ä–µ–º Acidic Bonding (–Ω–µ–∑–º–∏–≤–Ω–∏–π)",
                        "title": "–ö—Ä–µ–º Redken Acidic Bonding (–Ω–µ–∑–º–∏–≤–Ω–∏–π)",
                        "photo_path": "images/redken-acidic-leavein.jpg",
                        "short": "–ù–µ–∑–º–∏–≤–Ω–∏–π –¥–æ–≥–ª—è–¥ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É —Ç–∞ –≥–ª–∞–¥–∫–æ—Å—Ç—ñ. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ø—É—Ö–Ω–∞—Å—Ç—ñ—Å—Ç—å —ñ –ª–∞–º–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–µ–≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ –≤–æ–ª–æ–≥—É –¥–æ–≤–∂–∏–Ω—É. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {
                            "150 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 150, "price": 1000},
                        }
                    },
                }
            },

            "Acidic Color Gloss": {
                "items": {
                    "color_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Acidic Color Gloss",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Acidic Color Gloss",
                        "photo_path": "images/redken-color-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —è—Å–∫—Ä–∞–≤–æ—Å—Ç—ñ —Ç–∞ –±–ª–∏—Å–∫—É —Ñ–∞—Ä–±–æ–≤–∞–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –î–æ–ø–æ–º–∞–≥–∞—î –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—è—è–Ω–Ω—è —ñ –≥–ª–∞–¥–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950}}
                    },
                    "color_conditioner": {
                        "btn": "üîπ –ë–∞–ª—å–∑–∞–º Acidic Color Gloss",
                        "title": "–ë–∞–ª—å–∑–∞–º Redken Acidic Color Gloss",
                        "photo_path": "images/redken-color-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –±–ª–∏—Å–∫—É —Ç–∞ –º‚Äô—è–∫–æ—Å—Ç—ñ —Ñ–∞—Ä–±–æ–≤–∞–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –ü–æ–ª–µ–≥—à—É—î —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è, –∑–º–µ–Ω—à—É—î –ø–æ—Ä–∏—Å—Ç—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950}}
                    },
                    "color_fluid": {
                        "btn": "üîπ –§–ª—é—ó–¥ Acidic Color Gloss",
                        "title": "–§–ª—é—ó–¥ Redken Acidic Color Gloss",
                        "photo_path": "images/redken-color-fluid.jpg",
                        "short": "–ù–µ–∑–º–∏–≤–Ω–∏–π —Ñ–ª—é—ó–¥ –¥–ª—è –±–ª–∏—Å–∫—É —Ç–∞ –∑–∞—Ö–∏—Å—Ç—É —Ñ–∞—Ä–±–æ–≤–∞–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –î–æ–ø–æ–º–∞–≥–∞—î –∑–±–µ—Ä–µ–≥—Ç–∏ –≥–ª–∞–¥–∫—ñ—Å—Ç—å –¥–æ–≤–∂–∏–Ω–∏.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥—É –∞–±–æ —Å—É—Ö—É –¥–æ–≤–∂–∏–Ω—É. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"100 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 100, "price": 1000}}
                    },
                    "color_treatment": {
                        "btn": "üîπ –Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∏–π –¥–æ–≥–ª—è–¥ Acidic Color Gloss",
                        "title": "–Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∏–π –¥–æ–≥–ª—è–¥ Redken Acidic Color Gloss (Gloss Treatment)",
                        "photo_path": "images/redken-color-treatment.jpg",
                        "short": "–î–æ–≥–ª—è–¥ –¥–ª—è —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ —Å—è—è–Ω–Ω—è —Ç–∞ –±—ñ–ª—å—à ¬´–¥–æ—Ä–æ–≥–æ–≥–æ¬ª –≤–∏–≥–ª—è–¥—É –≤–æ–ª–æ—Å—Å—è. –ü—ñ–¥—Å–∏–ª—é—î –±–ª–∏—Å–∫ —ñ –∑–≥–ª–∞–¥–∂—É—î –¥–æ–≤–∂–∏–Ω—É.",
                        "how_to_use": "–ü—ñ—Å–ª—è —à–∞–º–ø—É–Ω—é –Ω–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω, –∑–º–∏—Ç–∏.",
                        "volumes": {"237 –º–ª ‚Äî 1400 –≥—Ä–Ω": {"ml": 237, "price": 1400}}
                    },
                    "color_thermo": {
                        "btn": "üîπ –°–ø—Ä–µ–π-—Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç Acidic Color Gloss",
                        "title": "–°–ø—Ä–µ–π-—Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç Redken Acidic Color Gloss",
                        "photo_path": "images/redken-color-thermo.jpg",
                        "short": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –¥–ª—è —Ñ–∞—Ä–±–æ–≤–∞–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è –∑ –µ—Ñ–µ–∫—Ç–æ–º –±–ª–∏—Å–∫—É. –î–æ–ø–æ–º–∞–≥–∞—î –∑–±–µ—Ä–µ–≥—Ç–∏ –≥–ª–∞–¥–∫—ñ—Å—Ç—å –ø—ñ–¥ —á–∞—Å —É–∫–ª–∞–¥–∫–∏.",
                        "how_to_use": "–†–æ–∑–ø–∏–ª–∏—Ç–∏ –ø–æ –¥–æ–≤–∂–∏–Ω—ñ –ø–µ—Ä–µ–¥ —Å—É—à—ñ–Ω–Ω—è–º –∞–±–æ —É–∫–ª–∞–¥–∫–æ—é. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"190 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 190, "price": 950}}
                    },
                }
            },

            "All Soft": {
                "items": {
                    "allsoft_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å All Soft",
                        "title": "–®–∞–º–ø—É–Ω—å Redken All Soft",
                        "photo_path": "images/redken-allsoft-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –º‚Äô—è–∫–æ—Å—Ç—ñ —Ç–∞ –±–ª–∏—Å–∫—É —Å—É—Ö–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –î–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–±–∏—Ç–∏ –¥–æ–≤–∂–∏–Ω—É –±—ñ–ª—å—à —à–æ–≤–∫–æ–≤–∏—Å—Ç–æ—é.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "allsoft_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä All Soft",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken All Soft",
                        "photo_path": "images/redken-allsoft-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –º‚Äô—è–∫–æ—Å—Ç—ñ, –≥–ª–∞–¥–∫–æ—Å—Ç—ñ —Ç–∞ –ª–µ–≥–∫–æ–≥–æ —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å —Å—É—Ö—ñ–π –¥–æ–≤–∂–∏–Ω—ñ.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "allsoft_thermo_cream": {
                        "btn": "üîπ –¢–µ—Ä–º–æ–∫—Ä–µ–º All Soft",
                        "title": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –∫—Ä–µ–º Redken All Soft",
                        "photo_path": "images/redken-allsoft-thermo-cream.jpg",
                        "short": "–¢–µ—Ä–º–æ–∫—Ä–µ–º –¥–ª—è –º‚Äô—è–∫–æ—Å—Ç—ñ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –ø—É—Ö–Ω–∞—Å—Ç–æ—Å—Ç—ñ. –î–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–±–∏—Ç–∏ —É–∫–ª–∞–¥–∫—É –±—ñ–ª—å—à –≥–ª–∞–¥–∫–æ—é.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–µ–≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ –≤–æ–ª–æ–≥—É –¥–æ–≤–∂–∏–Ω—É –ø–µ—Ä–µ–¥ —Å—É—à—ñ–Ω–Ω—è–º. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"150 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 150, "price": 950}}
                    },
                    "allsoft_oil": {
                        "btn": "üîπ –û–ª—ñ–π–∫–∞ All Soft",
                        "title": "–§–ª—é—ó–¥-–æ–ª—ñ–π–∫–∞ Redken All Soft",
                        "photo_path": "images/redken-allsoft-oil.jpg",
                        "short": "–û–ª—ñ–π–∫–∞-—Ñ–ª—é—ó–¥ –¥–ª—è –±–ª–∏—Å–∫—É —Ç–∞ –º‚Äô—è–∫–æ—Å—Ç—ñ. –î–æ–ø–æ–º–∞–≥–∞—î –∑–≥–ª–∞–¥–∏—Ç–∏ –¥–æ–≤–∂–∏–Ω—É —Ç–∞ –∑–º–µ–Ω—à–∏—Ç–∏ —Å—É—Ö—ñ—Å—Ç—å.",
                        "how_to_use": "1‚Äì2 –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –¥–æ–≤–∂–∏–Ω—É (–≤–æ–ª–æ–≥—É –∞–±–æ —Å—É—Ö—É). –ù–µ –Ω–∞–Ω–æ—Å–∏—Ç–∏ –Ω–∞ –∫–æ—Ä—ñ–Ω—å.",
                        "volumes": {"111 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 111, "price": 1000}}
                    },
                }
            },

            "All Soft Mega Curls": {
                "items": {
                    "megacurls_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Mega Curls",
                        "title": "–®–∞–º–ø—É–Ω—å Redken All Soft Mega Curls",
                        "photo_path": "images/redken-mega-curls-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è —Ö–≤–∏–ª—è—Å—Ç–æ–≥–æ —Ç–∞ –∫—É—á–µ—Ä—è–≤–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –î–∞—î –º‚Äô—è–∫—ñ—Å—Ç—å, –µ–ª–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å –ª–æ–∫–æ–Ω–∞.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 300, "price": 900}}
                    },
                    "megacurls_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Mega Curls",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken All Soft Mega Curls",
                        "photo_path": "images/redken-mega-curls-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –º‚Äô—è–∫–æ—Å—Ç—ñ –∫—É—á–µ—Ä—ñ–≤ –±–µ–∑ –æ–±—Ç—è–∂–µ–Ω–Ω—è. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ø—É—Ö–Ω–∞—Å—Ç—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 300, "price": 900}}
                    },
                }
            },

            "Blondage": {
                "items": {
                    "blondage_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Blondage",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Blondage",
                        "photo_path": "images/redken-blondage-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –¥–æ–≥–ª—è–¥—É –∑–∞ —Å–≤—ñ—Ç–ª–∏–º –≤–æ–ª–æ—Å—Å—è–º. –î–æ–ø–æ–º–∞–≥–∞—î –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —è–∫—ñ—Å—Ç—å –±–ª–æ–Ω–¥—É —Ç–∞ –º‚Äô—è–∫—ñ—Å—Ç—å –¥–æ–≤–∂–∏–Ω–∏.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏. –î–∞–ª—ñ –∫–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä.",
                        "volumes": {"300 –º–ª ‚Äî 800 –≥—Ä–Ω": {"ml": 300, "price": 800}}
                    },
                    "blondage_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Blondage",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Blondage",
                        "photo_path": "images/redken-blondage-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –º‚Äô—è–∫–æ—Å—Ç—ñ —Ç–∞ –±–ª–∏—Å–∫—É –±–ª–æ–Ω–¥—É. –ü–æ–ª–µ–≥—à—É—î —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è, –∑–≥–ª–∞–¥–∂—É—î –ø–æ—Ä–∏—Å—Ç—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 300, "price": 900}}
                    },
                    "blondage_purple_shampoo": {
                        "btn": "üîπ –§—ñ–æ–ª–µ—Ç–æ–≤–∏–π —à–∞–º–ø—É–Ω—å Blondage",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Blondage (–∞–Ω—Ç–∏-–∂–æ–≤—Ç–∏–π, —Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π)",
                        "photo_path": "images/redken-blondage-purple-shampoo.jpg",
                        "short": "–§—ñ–æ–ª–µ—Ç–æ–≤–∏–π —à–∞–º–ø—É–Ω—å –ø—Ä–æ—Ç–∏ –∂–æ–≤—Ç–∏–∑–Ω–∏. –ù–µ–π—Ç—Ä–∞–ª—ñ–∑—É—î —Ç–µ–ø–ª—ñ –≤—ñ–¥—Ç—ñ–Ω–∫–∏ —Ç–∞ —Ä–æ–±–∏—Ç—å –±–ª–æ–Ω–¥ —Ö–æ–ª–æ–¥–Ω—ñ—à–∏–º.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, –≤–∏—Ç—Ä–∏–º–∞—Ç–∏ 1‚Äì3 —Ö–≤ (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏ –¥–æ 5), –∑–º–∏—Ç–∏. 1‚Äì2 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.",
                        "volumes": {"300 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 300, "price": 900}}
                    },
                }
            },

            "Extreme": {
                "items": {
                    "extreme_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Extreme",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Extreme",
                        "photo_path": "images/redken-extreme-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ–≥–æ –≤–æ–ª–æ—Å—Å—è. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ª–∞–º–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {
                            "300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850},
                            "500 –º–ª ‚Äî 1100 –≥—Ä–Ω": {"ml": 500, "price": 1100},
                        }
                    },
                    "extreme_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Extreme",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Extreme",
                        "photo_path": "images/redken-extreme-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –ª–∞–º–∫–æ—Å—Ç—ñ.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {
                            "300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850},
                            "500 –º–ª ‚Äî 1100 –≥—Ä–Ω": {"ml": 500, "price": 1100},
                        }
                    },
                    "extreme_mask": {
                        "btn": "üîπ –ú–∞—Å–∫–∞ Extreme",
                        "title": "–ú–∞—Å–∫–∞ Redken Extreme",
                        "photo_path": "images/redken-extreme-mask.jpg",
                        "short": "–ú–∞—Å–∫–∞ –¥–ª—è –±—ñ–ª—å—à –≥–ª–∏–±–æ–∫–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏.",
                        "how_to_use": "–ü—ñ—Å–ª—è —à–∞–º–ø—É–Ω—é –Ω–∞ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω, –∑–º–∏—Ç–∏. 1‚Äì2 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.",
                        "volumes": {"250 –º–ª ‚Äî 1200 –≥—Ä–Ω": {"ml": 250, "price": 1200}}
                    },
                    "extreme_thermo": {
                        "btn": "üîπ –¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç Extreme (–Ω–µ–∑–º–∏–≤–Ω–∏–π)",
                        "title": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –Ω–µ–∑–º–∏–≤–Ω–∏–π Redken Extreme",
                        "photo_path": "images/redken-extreme-thermo.jpg",
                        "short": "–ù–µ–∑–º–∏–≤–Ω–∏–π —Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –¥–ª—è –¥–æ–≤–∂–∏–Ω–∏. –î–æ–ø–æ–º–∞–≥–∞—î –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–æ–ª–æ—Ç–Ω–æ –≤–æ–ª–æ—Å—Å—è –ø—ñ–¥ —á–∞—Å —Å—É—à—ñ–Ω–Ω—è —Ç–∞ —É–∫–ª–∞–¥–∫–∏.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –ø–µ—Ä–µ–¥ —Å—É—à—ñ–Ω–Ω—è–º/–ø—Ä–∞—Å–∫–æ—é. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"250 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 250, "price": 1000}}
                    },
                }
            },

            "Extreme Length": {
                "items": {
                    "extreme_length_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Extreme Length",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Extreme Length",
                        "photo_path": "images/redken-extreme-length-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è —Ç–∞ —Ä–æ—Å—Ç—É –¥–æ–≤–∂–∏–Ω–∏. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ª–∞–º–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏. –î–∞–ª—ñ –∫–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "extreme_length_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Extreme Length",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Extreme Length",
                        "photo_path": "images/redken-extreme-length-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ —Ç–∞ –ª–µ–≥–∫–æ–≥–æ —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 300, "price": 900}}
                    },
                    "extreme_length_mask": {
                        "btn": "üîπ –ú–∞—Å–∫–∞ Extreme Length",
                        "title": "–ú–∞—Å–∫–∞ Redken Extreme Length",
                        "photo_path": "images/redken-extreme-length-mask.jpg",
                        "short": "–ú–∞—Å–∫–∞ –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –ª–∞–º–∫–æ–º—É –≤–æ–ª–æ—Å—Å—é.",
                        "how_to_use": "–ü—ñ—Å–ª—è —à–∞–º–ø—É–Ω—é –Ω–∞ 5‚Äì10 —Ö–≤–∏–ª–∏–Ω, –∑–º–∏—Ç–∏. 1‚Äì2 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.",
                        "volumes": {"250 –º–ª ‚Äî 1200 –≥—Ä–Ω": {"ml": 250, "price": 1200}}
                    },
                    "extreme_length_cream": {
                        "btn": "üîπ –ö—Ä–µ–º Extreme Length (–Ω–µ–∑–º–∏–≤–Ω–∏–π)",
                        "title": "–ö—Ä–µ–º Redken Extreme Length (–Ω–µ–∑–º–∏–≤–Ω–∏–π)",
                        "photo_path": "images/redken-extreme-length-cream.jpg",
                        "short": "–ù–µ–∑–º–∏–≤–Ω–∏–π –∫—Ä–µ–º –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –¥–æ–≤–∂–∏–Ω–∏. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ª–∞–º–∫—ñ—Å—Ç—å —ñ –∑—Ä–æ–±–∏—Ç–∏ –≤–æ–ª–æ—Å—Å—è —Å–ª—É—Ö–Ω—è–Ω—ñ—à–∏–º.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥—É –∞–±–æ —Å—É—Ö—É –¥–æ–≤–∂–∏–Ω—É. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"150 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 150, "price": 1000}}
                    },
                }
            },

            "Frizz Dismiss": {
                "items": {
                    "frizz_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Frizz Dismiss",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Frizz Dismiss",
                        "photo_path": "images/redken-frizz-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –ø—Ä–æ—Ç–∏ –ø—É—Ö–Ω–∞—Å—Ç–æ—Å—Ç—ñ. –î–æ–ø–æ–º–∞–≥–∞—î –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ñ—Ä–∏–∑ —Ç–∞ —Ä–æ–±–∏—Ç—å –≤–æ–ª–æ—Å—Å—è –±—ñ–ª—å—à –≥–ª–∞–¥–∫–∏–º.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "frizz_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Frizz Dismiss",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Frizz Dismiss",
                        "photo_path": "images/redken-frizz-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –≥–ª–∞–¥–∫–æ—Å—Ç—ñ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –ø—É—Ö–Ω–∞—Å—Ç–æ—Å—Ç—ñ. –ü–æ–ª–µ–≥—à—É—î —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "frizz_thermo_cream": {
                        "btn": "üîπ –¢–µ—Ä–º–æ–∫—Ä–µ–º Frizz Dismiss",
                        "title": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –∫—Ä–µ–º Redken Frizz Dismiss",
                        "photo_path": "images/redken-frizz-thermo-cream.jpg",
                        "short": "–ö—Ä–µ–º-—Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –¥–ª—è –≥–ª–∞–¥–∫–æ—Å—Ç—ñ. –î–æ–ø–æ–º–∞–≥–∞—î –ø—Ä–∏–±—Ä–∞—Ç–∏ –ø—É—Ö–Ω–∞—Å—Ç—ñ—Å—Ç—å —Ç–∞ –∑–∞—Ö–∏—â–∞—î –ø—ñ–¥ —á–∞—Å —É–∫–ª–∞–¥–∫–∏.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–µ–≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ –≤–æ–ª–æ–≥—É –¥–æ–≤–∂–∏–Ω—É. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"250 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 250, "price": 1000}}
                    },
                    "frizz_oil_serum": {
                        "btn": "üîπ –û–ª—ñ–π–∫–∞-—Å–∏—Ä–æ–≤–∞—Ç–∫–∞ Frizz Dismiss",
                        "title": "–û–ª—ñ–π–∫–∞-—Å–∏—Ä–æ–≤–∞—Ç–∫–∞ Redken Frizz Dismiss",
                        "photo_path": "images/redken-frizz-oil-serum.jpg",
                        "short": "–û–ª—ñ–π–∫–∞ –¥–ª—è –±–ª–∏—Å–∫—É —Ç–∞ –∑–∞—Ö–∏—Å—Ç—É. –ó–∞–∫—Ä–∏–≤–∞—î –ø—É—Ö–Ω–∞—Å—Ç—ñ—Å—Ç—å —ñ —Ä–æ–±–∏—Ç—å –¥–æ–≤–∂–∏–Ω—É –±—ñ–ª—å—à –≥–ª–∞–¥–∫–æ—é.",
                        "how_to_use": "1‚Äì2 –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –¥–æ–≤–∂–∏–Ω—É. –ù–µ –Ω–∞–Ω–æ—Å–∏—Ç–∏ –Ω–∞ –∫–æ—Ä—ñ–Ω—å.",
                        "volumes": {"125 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 125, "price": 1000}}
                    },
                }
            },

            "Volume Injection": {
                "items": {
                    "volume_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Volume Injection",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Volume Injection",
                        "photo_path": "images/redken-volume-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –ø—Ä–∏–∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –æ–±‚Äô—î–º—É. –ü—ñ–¥–Ω—ñ–º–∞—î –∫–æ—Ä—ñ–Ω—å, –Ω–µ –æ–±—Ç—è–∂—É—î –¥–æ–≤–∂–∏–Ω—É.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                    "volume_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Volume Injection",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Volume Injection",
                        "photo_path": "images/redken-volume-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –æ–±‚Äô—î–º—É –±–µ–∑ –æ–±—Ç—è–∂–µ–Ω–Ω—è. –ü–æ–º‚Äô—è–∫—à—É—î –¥–æ–≤–∂–∏–Ω—É —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î –ª–µ–≥–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                }
            },

            "Amino Mint": {
                "items": {
                    "amino_mint_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Amino Mint",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Amino Mint",
                        "photo_path": "images/redken-amino-mint-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è —à–∫—ñ—Ä–∏ –≥–æ–ª–æ–≤–∏ –∑ –≤—ñ–¥—á—É—Ç—Ç—è–º —Å–≤—ñ–∂–æ—Å—Ç—ñ. –î–æ–±—Ä–µ –æ—á–∏—â–∞—î, –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –ø—Ä–∏ —à–≤–∏–¥–∫–æ–º—É –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—ñ –∫–æ—Ä–µ–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ —à–∫—ñ—Ä—É –≥–æ–ª–æ–≤–∏, —Å–ø—ñ–Ω–∏—Ç–∏ 1‚Äì2 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏. –î–æ–≤–∂–∏–Ω—É –ø—Ä–æ–º–∏—Ç–∏ –ø—ñ–Ω–æ—é.",
                        "volumes": {"300 –º–ª ‚Äî 850 –≥—Ä–Ω": {"ml": 300, "price": 850}}
                    },
                }
            },

            "Acidic Grow Full": {
                "items": {
                    "growfull_shampoo": {
                        "btn": "üîπ –®–∞–º–ø—É–Ω—å Acidic Grow Full",
                        "title": "–®–∞–º–ø—É–Ω—å Redken Acidic Grow Full",
                        "photo_path": "images/redken-growfull-shampoo.jpg",
                        "short": "–®–∞–º–ø—É–Ω—å –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –≤–æ–ª–æ—Å—Å—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≥—É—Å—Ç–æ—Ç–∏. –î–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –ª–∞–º–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏, —Å–ø—ñ–Ω–∏—Ç–∏, –∑–º–∏—Ç–∏. –î–∞–ª—ñ –∫–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä.",
                        "volumes": {"300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950}}
                    },
                    "growfull_conditioner": {
                        "btn": "üîπ –ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Acidic Grow Full",
                        "title": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä Redken Acidic Grow Full",
                        "photo_path": "images/redken-growfull-conditioner.jpg",
                        "short": "–ö–æ–Ω–¥–∏—Ü—ñ–æ–Ω–µ—Ä –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ —Ç–∞ –ª–µ–≥–∫–æ–≥–æ —Ä–æ–∑—á—ñ—Å—É–≤–∞–Ω–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –¥–æ–≤–∂–∏–Ω—É –Ω–∞ 1‚Äì3 —Ö–≤–∏–ª–∏–Ω–∏, –∑–º–∏—Ç–∏.",
                        "volumes": {"300 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 300, "price": 950}}
                    },
                    "growfull_scalp_serum": {
                        "btn": "üîπ –°–∏—Ä–æ–≤–∞—Ç–∫–∞ –¥–ª—è —à–∫—ñ—Ä–∏ –≥–æ–ª–æ–≤–∏ Grow Full",
                        "title": "–°–∏—Ä–æ–≤–∞—Ç–∫–∞ –¥–ª—è —à–∫—ñ—Ä–∏ –≥–æ–ª–æ–≤–∏ Redken Acidic Grow Full",
                        "photo_path": "images/redken-growfull-scalp-serum.jpg",
                        "short": "–°–∏—Ä–æ–≤–∞—Ç–∫–∞ –¥–ª—è –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≥—É—Å—Ç–æ—Ç–∏. –ü—Ä–∞—Ü—é—î –∑—ñ —à–∫—ñ—Ä–æ—é –≥–æ–ª–æ–≤–∏, –ø—ñ–¥—Ç—Ä–∏–º—É—î –∫–æ—Ä—ñ–Ω—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –ø–æ –ø—Ä–æ–¥—ñ–ª–∞—Ö –Ω–∞ —á–∏—Å—Ç—É —à–∫—ñ—Ä—É –≥–æ–ª–æ–≤–∏, –≤–º–∞—Å–∞–∂—É–≤–∞—Ç–∏. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"100 –º–ª ‚Äî 1400 –≥—Ä–Ω": {"ml": 100, "price": 1400}}
                    },
                    "growfull_thermo_spray": {
                        "btn": "üîπ –¢–µ—Ä–º–æ—Å–ø—Ä–µ–π Grow Full",
                        "title": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç-—Å–ø—Ä–µ–π Redken Acidic Grow Full",
                        "photo_path": "images/redken-growfull-thermo-spray.jpg",
                        "short": "–¢–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –¥–ª—è —É–∫–ª–∞–¥–∫–∏, –¥–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–±–∏—Ç–∏ –≤–æ–ª–æ—Å—Å—è –±—ñ–ª—å—à —â—ñ–ª—å–Ω–∏–º –≤—ñ–∑—É–∞–ª—å–Ω–æ.",
                        "how_to_use": "–†–æ–∑–ø–∏–ª–∏—Ç–∏ –ø–æ –¥–æ–≤–∂–∏–Ω—ñ –ø–µ—Ä–µ–¥ —Å—É—à—ñ–Ω–Ω—è–º/—É–∫–ª–∞–¥–∫–æ—é. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"190 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 190, "price": 950}}
                    },
                }
            },

            "Anti-Hair Loss": {
                "items": {
                    "anti_hair_loss": {
                        "btn": "üîπ Redken Anti-Hair Loss",
                        "title": "Redken Anti-Hair Loss (–∑–∞—Å—ñ–± –∑ –∞–º—ñ–Ω–æ–∫–∏—Å–ª–æ—Ç–∞–º–∏)",
                        "photo_path": "images/redken-anti-hair-loss.jpg",
                        "short": "–ó–∞—Å—ñ–± –∑ –∞–º—ñ–Ω–æ–∫–∏—Å–ª–æ—Ç–∞–º–∏ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –≤–∏–ø–∞–¥—ñ–Ω–Ω—é –≤–æ–ª–æ—Å—Å—è. –ü—ñ–¥—Ç—Ä–∏–º—É—î –∫–æ—Ä—ñ–Ω—å —É –ø–µ—Ä—ñ–æ–¥ —Å–µ–∑–æ–Ω–Ω–æ–≥–æ –∞–±–æ —Å—Ç—Ä–µ—Å–æ–≤–æ–≥–æ –≤–∏–ø–∞–¥—ñ–Ω–Ω—è.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –ø–æ –ø—Ä–æ–¥—ñ–ª–∞—Ö –Ω–∞ —á–∏—Å—Ç—É —à–∫—ñ—Ä—É –≥–æ–ª–æ–≤–∏, –≤–º–∞—Å–∞–∂—É–≤–∞—Ç–∏. –ù–µ –∑–º–∏–≤–∞—Ç–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫—É—Ä—Å–æ–º.",
                        "volumes": {"1 —à—Ç ‚Äî 1700 –≥—Ä–Ω": {"ml": None, "price": 1700}}
                    },
                }
            },

            "Styling": {
                "items": {
                    "quick_blowout": {
                        "btn": "üîπ Quick Blowout (—Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç)",
                        "title": "–°–ø—Ä–µ–π-—Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç Redken Quick Blowout",
                        "photo_path": "images/redken-quick-blowout.jpg",
                        "short": "–õ–µ–≥–∫–∏–π —Ç–µ—Ä–º–æ–∑–∞—Ö–∏—Å—Ç –¥–ª—è —à–≤–∏–¥–∫–æ—ó —É–∫–ª–∞–¥–∫–∏ —Ñ–µ–Ω–æ–º. –î–∞—î –≥–ª–∞–¥–∫—ñ—Å—Ç—å —ñ –∫–æ–Ω—Ç—Ä–æ–ª—å.",
                        "how_to_use": "–†–æ–∑–ø–∏–ª–∏—Ç–∏ –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è –ø–µ—Ä–µ–¥ —Å—É—à—ñ–Ω–Ω—è–º. –ù–µ –∑–º–∏–≤–∞—Ç–∏.",
                        "volumes": {"125 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 125, "price": 950}}
                    },
                    "volume_boost": {
                        "btn": "üîπ Volume Boost (–æ–±‚Äô—î–º)",
                        "title": "–õ–µ–≥–∫–∏–π —Å–ø—Ä–µ–π –¥–ª—è –ø—Ä–∏–∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –æ–±‚Äô—î–º—É Redken Volume Boost",
                        "photo_path": "images/redken-volume-boost.jpg",
                        "short": "–°–ø—Ä–µ–π –¥–ª—è –ø—Ä–∏–∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –æ–±‚Äô—î–º—É. –ü—ñ–¥–Ω—ñ–º–∞—î –∫–æ—Ä—ñ–Ω—å —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î –ª–µ–≥–∫—ñ—Å—Ç—å.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –∫–æ—Ä—ñ–Ω—å –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, –≤–∏—Å—É—à–∏—Ç–∏ —Ñ–µ–Ω–æ–º.",
                        "volumes": {"250 –º–ª ‚Äî 950 –≥—Ä–Ω": {"ml": 250, "price": 950}}
                    },
                    "root_tease": {
                        "btn": "üîπ Root Tease (–Ω–∞—á—ñ—Å)",
                        "title": "–ü—Ä–∏–∫–æ—Ä–µ–Ω–µ–≤–∏–π —Å–ø—Ä–µ–π –¥–ª—è –µ—Ñ–µ–∫—Ç—É –Ω–∞—á—ñ—Å—É Redken Root Tease",
                        "photo_path": "images/redken-root-tease.jpg",
                        "short": "–°–ø—Ä–µ–π –¥–ª—è –≤–∏—Ä–∞–∂–µ–Ω–æ–≥–æ –æ–±‚Äô—î–º—É —ñ —Ñ—ñ–∫—Å–∞—Ü—ñ—ó –≤ –∫–æ—Ä–µ–Ω—ñ. –î–∞—î –µ—Ñ–µ–∫—Ç –Ω–∞—á—ñ—Å—É.",
                        "how_to_use": "–†–æ–∑–ø–∏–ª–∏—Ç–∏ –Ω–∞ –∫–æ—Ä—ñ–Ω—å, –ø—ñ–¥–Ω—è—Ç–∏, –≤–∏—Å—É—à–∏—Ç–∏/–∑–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ —É–∫–ª–∞–¥–∫—É.",
                        "volumes": {"250 –º–ª ‚Äî 900 –≥—Ä–Ω": {"ml": 250, "price": 900}}
                    },
                    "root_lifter": {
                        "btn": "üîπ Root Lifter (—Å–ø—Ä–µ–π-–º—É—Å)",
                        "title": "–°–ø—Ä–µ–π-–º—É—Å —Å–µ—Ä–µ–¥–Ω—å–æ—ó —Ñ—ñ–∫—Å–∞—Ü—ñ—ó Redken Root Lifter",
                        "photo_path": "images/redken-root-lifter.jpg",
                        "short": "–°–ø—Ä–µ–π-–º—É—Å –¥–ª—è –æ–±‚Äô—î–º—É –∑ –∫–µ—Ä–æ–≤–∞–Ω–æ—é —Ñ—ñ–∫—Å–∞—Ü—ñ—î—é –±–µ–∑ –∂–æ—Ä—Å—Ç–∫–æ—Å—Ç—ñ.",
                        "how_to_use": "–ù–∞–Ω–µ—Å—Ç–∏ –Ω–∞ –∫–æ—Ä—ñ–Ω—å –Ω–∞ –≤–æ–ª–æ–≥–µ –≤–æ–ª–æ—Å—Å—è, –≤–∏—Å—É—à–∏—Ç–∏ —Ñ–µ–Ω–æ–º, –ø—ñ–¥–Ω—ñ–º–∞—é—á–∏ –∫–æ—Ä—ñ–Ω—å.",
                        "volumes": {"300 –º–ª ‚Äî 1000 –≥—Ä–Ω": {"ml": 300, "price": 1000}}
                    },
                }
            },
        }
    },

    "EG by Gromova": {
        "lines": {
            "–°–∏—Å—Ç–µ–º–∞ –¥–æ–≥–ª—è–¥—É": {"items": {}},
        }
    }
}

# =========================
# LINES MENU (Redken)
# =========================
REDKEN_LINES_ROWS = [
    ("Acidic Bonding", "Acidic Color Gloss"),
    ("All Soft", "All Soft Mega Curls"),
    ("Blondage", "Extreme"),
    ("Extreme Length", "Frizz Dismiss"),
    ("Volume Injection", "Amino Mint"),
    ("Acidic Grow Full", "Anti-Hair Loss"),
    ("Styling",),
]

# =========================
# STATE
# =========================
user_nav = {}        # chat_id -> stack
user_selected = {}   # chat_id -> {"brand","line","item_key","volume_btn"}
user_cart = {}       # chat_id -> list of items
user_checkout = {}       # chat_id -> dict
user_checkout_step = {}  # chat_id -> int

SCR_MAIN = "main"
SCR_SALON = "salon"
SCR_PRICE = "price"
SCR_SHOP = "shop"
SCR_BRAND_REDKEN = "brand_redken"
SCR_ITEMS = "items"
SCR_ITEM = "item"
SCR_VOLUMES = "volumes"
SCR_CART = "cart"

CHECKOUT_FIELDS = [
    ("first_name", "–í–∫–∞–∂—ñ—Ç—å –≤–∞—à–µ —ñ–º‚Äô—è üëá"),
    ("last_name", "–í–∫–∞–∂—ñ—Ç—å –≤–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ üëá"),
    ("phone", "–í–∫–∞–∂—ñ—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É üìû\n–ü—Ä–∏–∫–ª–∞–¥: +380XXXXXXXXX"),
    ("city", "–í–∫–∞–∂—ñ—Ç—å –º—ñ—Å—Ç–æ üèôÔ∏è"),
    ("np_type", "–î–æ—Å—Ç–∞–≤–∫–∞ –ù–æ–≤–æ—é –ü–æ—à—Ç–æ—é:\n–ù–∞–ø–∏—à—ñ—Ç—å: –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∞–±–æ –ü–æ—à—Ç–æ–º–∞—Ç üì¶"),
    ("np_number", "–í–∫–∞–∂—ñ—Ç—å –Ω–æ–º–µ—Ä –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∞–±–æ –ø–æ—à—Ç–æ–º–∞—Ç—É üëá"),
]

def nav_init(chat_id: int):
    user_nav.setdefault(chat_id, [SCR_MAIN])
    user_selected.setdefault(chat_id, {})
    user_cart.setdefault(chat_id, [])

def nav_go(chat_id: int, screen: str):
    nav_init(chat_id)
    user_nav[chat_id].append(screen)

def nav_back(chat_id: int):
    nav_init(chat_id)
    if len(user_nav[chat_id]) > 1:
        user_nav[chat_id].pop()

def nav_current(chat_id: int) -> str:
    nav_init(chat_id)
    return user_nav[chat_id][-1]

# =========================
# RENDER
# =========================
def show_main(chat_id: int):
    bot.send_message(chat_id, "–í—ñ—Ç–∞—î–º–æ üíõ\n–û–±–µ—Ä—ñ—Ç—å —Ä–æ–∑–¥—ñ–ª –Ω–∏–∂—á–µ:", reply_markup=kb_main())

def show_salon(chat_id: int):
    bot.send_message(chat_id, "–†–æ–∑–¥—ñ–ª: –°–∞–ª–æ–Ω ‚úÇÔ∏è\n–û–±–µ—Ä—ñ—Ç—å, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ:", reply_markup=kb_salon())

def show_price(chat_id: int):
    bot.send_message(chat_id, "–ü—Ä–∞–π—Å —Å–∞–ª–æ–Ω—É üí∞\n–û–±–µ—Ä—ñ—Ç—å –ø–æ—Å–ª—É–≥—É:", reply_markup=kb_price(PRICE_ROWS))

def show_shop(chat_id: int):
    bot.send_message(chat_id, "–ú–∞–≥–∞–∑–∏–Ω –∫–æ—Å–º–µ—Ç–∏–∫–∏ üõçÔ∏è\n–û–±–µ—Ä—ñ—Ç—å –±—Ä–µ–Ω–¥:", reply_markup=kb_shop())

def show_redken_lines(chat_id: int):
    bot.send_message(chat_id, "Redken üß¥\n–û–±–µ—Ä—ñ—Ç—å –ª—ñ–Ω—ñ–π–∫—É:", reply_markup=kb_lines(REDKEN_LINES_ROWS))

def show_cart(chat_id: int):
    bot.send_message(chat_id, "–ö–æ—à–∏–∫ üß∫\n–û–±–µ—Ä—ñ—Ç—å –¥—ñ—é:", reply_markup=kb_cart())

def show_line_items(chat_id: int):
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    if not brand or not line:
        show_redken_lines(chat_id)
        return

    items = CATALOG[brand]["lines"][line]["items"]
    if not items:
        bot.send_message(chat_id, "–£ —Ü—ñ–π –ª—ñ–Ω—ñ–π—Ü—ñ –ø–æ–∫–∏ –Ω–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤ ‚úÖ", reply_markup=kb_lines(REDKEN_LINES_ROWS))
        return

    btns = []
    for k, item in items.items():
        btns.append(item.get("btn") or item.get("title") or k)

    rows = []
    for i in range(0, len(btns), 2):
        rows.append(tuple(btns[i:i+2]))

    bot.send_message(chat_id, f"{line} üß¥\n–û–±–µ—Ä—ñ—Ç—å —Ç–æ–≤–∞—Ä:", reply_markup=kb_items(rows))

def format_prices(item: dict) -> str:
    vols = item.get("volumes", {}) or {}
    if not vols:
        return ""
    # –∫—Ä–∞—Å–∏–≤–æ –≤—ã–≤–æ–¥–∏–º –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
    lines = []
    for k in vols.keys():
        lines.append(f"‚Ä¢ {k}")
    return "\n".join(lines)

def show_item(chat_id: int):
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    item_key = sel.get("item_key")

    item = CATALOG[brand]["lines"][line]["items"][item_key]

    # –§–æ—Ä–º–∏—Ä—É–µ–º –±–ª–æ–∫ —Ü–µ–Ω
    vols = item.get("volumes", {})
    price_text = ""
    for k in vols.keys():
        price_text += f"‚Ä¢ {k}\n"

    full_block = ""
    if item.get("full"):
        full_block = f"\n<b>–û–ø–∏—Å:</b>\n{item['full']}\n"

    caption = (
        f"<b>{item['title']}</b>\n\n"
        f"{item['short']}\n"
        f"{full_block}\n"
        f"<b>–¶—ñ–Ω–∏:</b>\n{price_text}\n"
        "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–í–∏–±—Ä–∞—Ç–∏ –æ–± º—î–º¬ª."
    )

    photo = item.get("photo", "").strip()

    if photo and os.path.exists(photo):
        with open(photo, "rb") as f:
            bot.send_photo(chat_id, f, caption=caption, reply_markup=kb_product())
    else:
        bot.send_message(chat_id, caption, reply_markup=kb_product())

def show_volumes(chat_id: int):
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    item_key = sel.get("item_key")
    if not brand or not line or not item_key:
        show_redken_lines(chat_id)
        return

    item = CATALOG[brand]["lines"][line]["items"][item_key]
    volume_buttons = list(item.get("volumes", {}).keys())
    if not volume_buttons:
        bot.send_message(chat_id, "–î–ª—è —Ü—å–æ–≥–æ —Ç–æ–≤–∞—Ä—É –Ω–µ –∑–∞–¥–∞–Ω—ñ –æ–±‚Äô—î–º–∏ ‚ùå", reply_markup=kb_product())
        return

    rows = []
    for i in range(0, len(volume_buttons), 2):
        rows.append(tuple(volume_buttons[i:i+2]))

    bot.send_message(chat_id, "–û–±–µ—Ä—ñ—Ç—å –æ–± º—î–º:", reply_markup=kb_volumes(rows))

# =========================
# COMMANDS
# =========================
@bot.message_handler(commands=["start"])
def cmd_start(message):
    if not is_private(message):
        return
    chat_id = message.chat.id
    nav_init(chat_id)
    user_nav[chat_id] = [SCR_MAIN]
    user_selected[chat_id] = {}
    show_main(chat_id)

@bot.message_handler(commands=["id"])
def cmd_id(message):
    chat_id = message.chat.id
    user_id = message.from_user.id if message.from_user else None
    bot.send_message(chat_id, f"chat_id: {chat_id}\nuser_id: {user_id}", reply_markup=types.ReplyKeyboardRemove())

# =========================
# GLOBAL NAV
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_HOME)
def handle_home(message):
    chat_id = message.chat.id
    nav_init(chat_id)
    user_nav[chat_id] = [SCR_MAIN]
    show_main(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_BACK)
def handle_back(message):
    chat_id = message.chat.id
    nav_back(chat_id)
    cur = nav_current(chat_id)

    if cur == SCR_MAIN:
        show_main(chat_id)
        return
    if cur == SCR_SALON:
        show_salon(chat_id)
        return
    if cur == SCR_PRICE:
        show_price(chat_id)
        return
    if cur == SCR_SHOP:
        show_shop(chat_id)
        return
    if cur == SCR_BRAND_REDKEN:
        show_redken_lines(chat_id)
        return
    if cur == SCR_ITEMS:
        show_line_items(chat_id)
        return
    if cur == SCR_ITEM:
        show_item(chat_id)
        return
    if cur == SCR_CART:
        show_cart(chat_id)
        return

    show_main(chat_id)

# =========================
# MAIN MENU
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_SALON)
def open_salon(message):
    chat_id = message.chat.id
    nav_go(chat_id, SCR_SALON)
    show_salon(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_SHOP)
def open_shop(message):
    chat_id = message.chat.id
    nav_go(chat_id, SCR_SHOP)
    show_shop(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_ADMIN)
def contact_admin(message):
    chat_id = message.chat.id
    bot.send_message(chat_id, f"–ù–∞–ø–∏—à—ñ—Ç—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É üëá\n{ADMIN_LINK}", reply_markup=kb_main())

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_CART)
def open_cart(message):
    chat_id = message.chat.id
    nav_go(chat_id, SCR_CART)
    show_cart(chat_id)

# =========================
# SALON
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_PRICE)
def open_price(message):
    chat_id = message.chat.id
    nav_go(chat_id, SCR_PRICE)
    show_price(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.text in SERVICE_TEXTS)
def show_service(message):
    chat_id = message.chat.id
    bot.send_message(chat_id, SERVICE_TEXTS[message.text], reply_markup=kb_price(PRICE_ROWS))

# =========================
# SHOP
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_REDKEN)
def open_redken(message):
    chat_id = message.chat.id
    user_selected[chat_id] = {"brand": "Redken"}
    nav_go(chat_id, SCR_BRAND_REDKEN)
    show_redken_lines(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_EG)
def open_eg(message):
    chat_id = message.chat.id
    bot.send_message(chat_id, "EG by Gromova (—Ç–æ–≤–∞—Ä–∏ –¥–æ–¥–∞–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –±–ª–æ–∫–æ–º) üíõ", reply_markup=kb_shop())

# =========================
# REDKEN LINES
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text in CATALOG["Redken"]["lines"].keys())
def redken_line(message):
    chat_id = message.chat.id
    line = message.text

    user_selected[chat_id] = {"brand": "Redken", "line": line, "item_key": None, "volume_btn": None}
    nav_go(chat_id, SCR_ITEMS)
    show_line_items(chat_id)

# =========================
# ITEM SELECT (buttons by item['btn'])
# =========================
@bot.message_handler(func=lambda m: is_private(m))
def handle_item_buttons(message):
    chat_id = message.chat.id
    txt = (message.text or "").strip()

    # —Å–Ω–∞—á–∞–ª–∞ ‚Äî –±—ã—Å—Ç—Ä—ã–µ –≤—ã—Ö–æ–¥—ã –ø–æ –∫–Ω–æ–ø–∫–∞–º –º–µ–Ω—é —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤—ã—à–µ –¥—Ä—É–≥–∏–º–∏ —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")

    if brand != "Redken" or not line:
        return

    items = CATALOG["Redken"]["lines"][line]["items"]
    btn_to_key = {}
    for k, item in items.items():
        b = (item.get("btn") or "").strip()
        if b:
            btn_to_key[b] = k

    if txt in btn_to_key:
        sel["item_key"] = btn_to_key[txt]
        sel["volume_btn"] = None
        user_selected[chat_id] = sel
        nav_go(chat_id, SCR_ITEM)
        show_item(chat_id)
        return

# =========================
# PRODUCT ACTIONS
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_CHOOSE_VOLUME)
def choose_volume(message):
    chat_id = message.chat.id
    sel = user_selected.get(chat_id, {})
    ok = sel.get("brand") and sel.get("line") and sel.get("item_key")
    if not ok:
        show_shop(chat_id)
        return
    nav_go(chat_id, SCR_VOLUMES)
    show_volumes(chat_id)

@bot.message_handler(func=lambda m: is_private(m))
def select_volume(message):
    chat_id = message.chat.id
    txt = (message.text or "").strip()

    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    item_key = sel.get("item_key")

    if not brand or not line or not item_key:
        return

    item = CATALOG[brand]["lines"][line]["items"][item_key]
    volumes = item.get("volumes", {})

    if txt in volumes:
        sel["volume_btn"] = txt
        v = volumes[txt]
        bot.send_message(
            chat_id,
            f"–û–±—Ä–∞–Ω–æ: {v.get('ml','')} –º–ª ‚Äî {v.get('price','')} –≥—Ä–Ω ‚úÖ\n–¢–µ–ø–µ—Ä –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´{BTN_ADD_TO_CART}¬ª.",
            reply_markup=kb_product()
        )
        # –≤–µ—Ä–Ω—ë–º—Å—è –Ω–∞–∑–∞–¥ —Å volumes –Ω–∞ item
        if nav_current(chat_id) == SCR_VOLUMES:
            nav_back(chat_id)
        return

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_HOW_TO_USE)
def how_to_use(message):
    chat_id = message.chat.id
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    item_key = sel.get("item_key")

    if not brand or not line or not item_key:
        show_shop(chat_id)
        return

    item = CATALOG[brand]["lines"][line]["items"][item_key]
    bot.send_message(chat_id, item["how_to_use"], reply_markup=kb_product())

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_ADD_TO_CART)
def add_to_cart(message):
    chat_id = message.chat.id
    sel = user_selected.get(chat_id, {})
    brand = sel.get("brand")
    line = sel.get("line")
    item_key = sel.get("item_key")
    volume_btn = sel.get("volume_btn")

    if not brand or not line or not item_key:
        show_shop(chat_id)
        return

    if not volume_btn:
        bot.send_message(chat_id, f"–°–ø–æ—á–∞—Ç–∫—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´{BTN_CHOOSE_VOLUME}¬ª ‚úÖ", reply_markup=kb_product())
        return

    item = CATALOG[brand]["lines"][line]["items"][item_key]
    v = item["volumes"][volume_btn]

    user_cart[chat_id].append({
        "title": item["title"],
        "ml": v.get("ml"),
        "price": v.get("price")
    })

    bot.send_message(
        chat_id,
        f"–î–æ–¥–∞–Ω–æ –≤ –∫–æ—à–∏–∫ ‚úÖ\n{item['title']} ‚Äî {v.get('ml','')} –º–ª ‚Äî {v.get('price','')} –≥—Ä–Ω\n\n–í—ñ–¥–∫—Ä–∏–π—Ç–µ –∫–æ—à–∏–∫ –∫–Ω–æ–ø–∫–æ—é ¬´{BTN_CART}¬ª.",
        reply_markup=kb_product()
    )

# =========================
# CART
# =========================
@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_CART_SHOW)
def cart_show(message):
    chat_id = message.chat.id
    items = user_cart.get(chat_id, [])

    if not items:
        bot.send_message(chat_id, "–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π ü´∂", reply_markup=kb_cart())
        return

    total = sum(int(i["price"]) for i in items if i.get("price") is not None)
    lines = []
    for idx, i in enumerate(items, 1):
        lines.append(f"{idx}) {i['title']} ‚Äî {i.get('ml','')} –º–ª ‚Äî {i.get('price','')} –≥—Ä–Ω")

    text = "–í–∞—à –∫–æ—à–∏–∫ üß∫\n\n" + "\n".join(lines) + f"\n\n–†–∞–∑–æ–º: {total} –≥—Ä–Ω"
    bot.send_message(chat_id, text, reply_markup=kb_cart())

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_CART_CLEAR)
def cart_clear(message):
    chat_id = message.chat.id
    user_cart[chat_id] = []
    bot.send_message(chat_id, "–ö–æ—à–∏–∫ –æ—á–∏—â–µ–Ω–æ ‚úÖ", reply_markup=kb_cart())

# =========================
# CHECKOUT
# =========================
def ask_next_field(chat_id: int):
    step = user_checkout_step.get(chat_id, 0)

    if step >= len(CHECKOUT_FIELDS):
        send_order_to_admin(chat_id)
        return

    _, question = CHECKOUT_FIELDS[step]
    bot.send_message(chat_id, question)

@bot.message_handler(func=lambda m: is_private(m) and m.text == BTN_CHECKOUT)
def start_checkout(message):
    chat_id = message.chat.id
    items = user_cart.get(chat_id, [])

    if not items:
        bot.send_message(chat_id, "–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π üß∫", reply_markup=kb_cart())
        return

    user_checkout[chat_id] = {}
    user_checkout_step[chat_id] = 0

    bot.send_message(
        chat_id,
        "–û—Ñ–æ—Ä–º–ª—é—î–º–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è üìù\n–í—ñ–¥–ø–æ–≤—ñ–¥–∞–π—Ç–µ –ø–æ —á–µ—Ä–∑—ñ.",
        reply_markup=types.ReplyKeyboardRemove()
    )
    ask_next_field(chat_id)

@bot.message_handler(func=lambda m: is_private(m) and m.chat.id in user_checkout_step)
def collect_checkout(message):
    chat_id = message.chat.id
    step = user_checkout_step.get(chat_id, 0)

    if step >= len(CHECKOUT_FIELDS):
        return

    key, _ = CHECKOUT_FIELDS[step]
    value = (message.text or "").strip()

    if key == "phone":
        cleaned = value.replace(" ", "").replace("-", "")
        good = cleaned.startswith("+") and len(cleaned) >= 10
        if not good:
            bot.send_message(chat_id, "–ù–æ–º–µ—Ä –≤–≤–µ–¥–µ–Ω–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ ‚ùå\n–ü—Ä–∏–∫–ª–∞–¥: +380XXXXXXXXX")
            return
        value = cleaned

    user_checkout[chat_id][key] = value
    user_checkout_step[chat_id] = step + 1
    ask_next_field(chat_id)

def send_order_to_admin(chat_id: int):
    items = user_cart.get(chat_id, [])
    data = user_checkout.get(chat_id, {})

    total = sum(int(i["price"]) for i in items if i.get("price") is not None)

    lines = []
    for idx, i in enumerate(items, 1):
        lines.append(f"{idx}) {i['title']} ‚Äî {i.get('ml','')} –º–ª ‚Äî {i.get('price','')} –≥—Ä–Ω")
    items_text = "\n".join(lines)

    text = (
        "üî• <b>–ù–û–í–ï –ó–ê–ú–û–í–õ–ï–ù–ù–Ø</b>\n\n"
        f"üë§ <b>–ö–ª—ñ—î–Ω—Ç:</b> {data.get('first_name','')} {data.get('last_name','')}\n"
        f"üìû <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> {data.get('phone','')}\n"
        f"üèôÔ∏è <b>–ú—ñ—Å—Ç–æ:</b> {data.get('city','')}\n"
        f"üì¶ <b>–ù–ü:</b> {data.get('np_type','')} ‚Ññ{data.get('np_number','')}\n\n"
        f"üß¥ <b>–¢–æ–≤–∞—Ä–∏:</b>\n{items_text}\n\n"
        f"üí∞ <b>–†–∞–∑–æ–º:</b> {total} –≥—Ä–Ω\n"
        f"üÜî <b>Chat ID –∫–ª—ñ—î–Ω—Ç–∞:</b> <code>{chat_id}</code>"
    )

    sent = safe_send_to_admin(text)

    if sent:
        bot.send_message(chat_id, "–î—è–∫—É—î–º–æ ‚ù§Ô∏è –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É.", reply_markup=kb_main())
    else:
        bot.send_message(chat_id, "–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É ‚ùå\n–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä: " + ADMIN_LINK, reply_markup=kb_main())

    user_cart[chat_id] = []
    user_checkout.pop(chat_id, None)
    user_checkout_step.pop(chat_id, None)

# =========================
# FALLBACK (LAST)
# =========================
@bot.message_handler(func=lambda m: True)
def fallback(message):
    if not is_private(message):
        return
    bot.send_message(message.chat.id, "–Ø –≤–∞—Å –∑—Ä–æ–∑—É–º—ñ–ª–∞ ‚úÖ\n–û–±–µ—Ä—ñ—Ç—å –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é –Ω–∏–∂—á–µ.", reply_markup=kb_main())

# =========================
# RUN
# =========================
bot.remove_webhook()
bot.infinity_polling(skip_pending=True)
